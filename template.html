<!DOCTYPE html>
<html>
  <header>
    <title>GLINT</title>
  </header>
  <body>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <div id="chart_div" style="height: 100vh;"></div>
    <script>
      const loadAndDrawData = () => {
      fetch("http://localhost:8080/data").then(
          (response) => {
            response.json().then((value) => {
              const rows = [['Name', 'Reviews Responded', 'Reviews Unresponded', { role: 'annotation' } ]];

              for (const key of Object.keys(value)) {
                if (value[key].timesRequested) {
                  rows.push([key, value[key].timesResponded, value[key].timesRequested - value[key].timesResponded, '' ]);
                }
              }

              const data = google.visualization.arrayToDataTable(rows);

              const options = {
                title: 'Requests Reviewed and Responded',
                chartArea: {width: '75%'},
                width: '100%',
                height: '100%',
                hAxis: {
                  title: 'Reviews Requested/Responded',
                  minValue: 0
                },
                vAxis: {
                  title: 'Name'
                },
                isStacked: true,
              };

              const chart = new google.visualization.BarChart(document.getElementById('chart_div'));
              chart.draw(data, options); 
            })  
          }
        )
      }

      google.charts.load('current', {packages: ['corechart', 'bar']});
      google.charts.setOnLoadCallback(loadAndDrawData);
    </script>
  </body>
</html>