<!DOCTYPE html>
<html>
  <header>
    <title>GLINT</title>
    <style>
      html, body, #container {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </header>
  <body>
    <script src="https://cdn.anychart.com/releases/8.0.0/js/anychart-base.min.js"></script>
    <div id="container"></div>
    <script>
      fetch("http://localhost:8080/data").then(
        (response) => {
          response.json().then((value) => {
            anychart.onDocumentReady(() => {
            
              const rows = [];

              for (const key of Object.keys(value)) {
                if (value[key].timesRequested) {
                  rows.push([key, value[key].timesRequested, value[key].timesResponded]);
                }
              }

              // create a data set
              const data = anychart.data.set(rows);

              // map the data
              const timesRequestedData = data.mapAs({x: 0, value: 1 });
              const timesRespondedData = data.mapAs({x: 0, value: 2 });

              // create a chart
              const chart = anychart.bar();

              // create series and set the data
              const timesRequested = chart.bar(timesRequestedData);
              const timesResponded = chart.bar(timesRespondedData);

              // Set names of bars
              timesRequested.name("Times Requested");
              timesResponded.name("Times Responded");

              // set axis
              chart.xAxis().title("Name");
              chart.yAxis().title("Times Requested/Responded");

              // set the chart title
              chart.title("Reviews Requested For Repo");


              // draw
              chart.container("container");
              chart.draw();
            });
          })  
        }
      )
    </script>
  </body>
</html>